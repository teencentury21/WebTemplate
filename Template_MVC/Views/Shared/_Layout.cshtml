<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @*<style>
            .captcha-box {
                width: 400px;
                margin: 0 auto;
            }

            #canvas {
                border: 1px solid #cccccc;
            }
        </style>*@

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/captcha")
    @Scripts.Render("~/bundles/bootstrap")

    <script type="text/javascript">
        console.log('Initial');
        // step-1
                
        const captcha = new Captcha($('#canvas'), {
            length: 6,                          // 校验码长度
            width: 150,                         // canvas宽度
            height: 50,                         // canvas高度
            font: 'bold 23px 微软雅黑',          // 文本字体样式
            resourceType: 'aA0',                // 资源类型：a-小写字母、A-大写字母、0-数字，可任意组合
            resourceExtra: [],                  // 额外资源
            clickRefresh: true,                 // 点击刷新
            autoRefresh: true,                  // 调用校验接口后是否自动刷新（校验成功不会刷新）
            caseSensitive: false,               // 大小写是否敏感
        });
        // init
        $(function () {

        });

        $('#refresh').on('click', function() {
            captcha.refresh();
        });
        $('#valid').on('click', function() {
            const val = $('input[name="code"]').val();
            if (val === "") {
            alert("请输入验证码");
            return
            }
            console.log("val:", val);
            console.log("code:", captcha.getCode());
            if (captcha.valid(val)) {
            // success
            $("#txt_msg").val('pass');
            alert('验证通过');
            } else {
            // failure
                //$("#txt_msg").val(@Resources.Resource.ErrorCaptcha);
            $("#txt_msg").val('error');
            alert('验证码错误');
            }
        });

        // modal login/ regist
        var myModal = document.getElementById('loginModal')
        var myModalTab = document.getElementById('login-register-tabs')
        var modal = new bootstrap.Modal(myModal)
        var tab = new bootstrap.Tab(myModalTab)

        document.querySelector('.btn-primary').addEventListener('click', function () {
            modal.show()
            tab.show('login-tab')
        });
    </script>

    @RenderSection("scripts", required: false)
</head>
<body>
    <!-- Nav header-->
    <nav class="navbar navbar-dark bg-dark navbar-expand-lg">
        <div class="container">
            @*<a class="navbar-brand" href="#">Navbar</a>*@
            <a class="navbar-brand" href="~/">
                <img src="~/Images/Darfon_logo_w.png" alt="Bootstrap" width="90" height="25">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="~/">@Resources.Resource.Home</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            @Resources.Resource.Query
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href='/Query/Localization'>Localization</a></li>
                            @*<li><a class="dropdown-item" href='/Query/Localization'>@Resource.Content.Language</a></li>*@
                            @*<li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="https://google.com">Action</a></li>
                                <li><a class="dropdown-item" href="#">Another action</a></li>
                                <li><a class="dropdown-item" href="#">Something else here</a></li>*@
                        </ul>
                    </li>

                    @*<li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>*@
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Functions
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href='/help'>API</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="https://google.com">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled">Disabled</a>
                    </li>
                </ul>
                <button id="btn-login" class="btn btn-outline-info me-2" type="button" data-bs-toggle="modal" data-bs-target="#loginModal">@Resources.Resource.LoginTitle</button>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            @Resources.Resource.Language
                        </a>
                        <ul id="dropdown_lang" class="dropdown-menu">
                            <li><a id="lang_en" class="dropdown-item" href="~/Home/ChangeLanguage?lang=en"><span class="fi fi-en"></span>@Resources.Resource.English</a> </li>
                            <li><a id="lang_tw" class="dropdown-item" href="~/Home/ChangeLanguage?lang=zh-TW"><span class="fi fi-tw"></span>@Resources.Resource.ChineseTraditional</a> </li>
                            <li><a id="lang_cn" class="dropdown-item" href="~/Home/ChangeLanguage?lang=zh-CN"><span class="fi fi-cn"></span>@Resources.Resource.ChineseSimple</a> </li>
                            <li><a id="lang_vn" class="dropdown-item" href="~/Home/ChangeLanguage?lang=vi-VN"><span class="fi fi-vn"></span>@Resources.Resource.Vietnamese</a> </li>
                        </ul>
                    </li>
                </ul>
                @*<form class="d-flex" role="search">
                        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                        <button class="btn btn-outline-success" type="submit">Search</button>
                    </form>*@
            </div>
        </div>
    </nav>
    <div class="container body-content">
        <canvas id="canvas"></canvas>
        <button id="refresh">刷新</button>
        <input name="code">
        <button id="valid">校验</button>
        <input id="txt_msg" type="text" readonly />
        @RenderBody()
        <!-- Footer -->
        <div class="container">
            <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
                <p class="col-md-4 mb-0 text-muted">Copyright &copy; @DateTime.Now.Year Darfon Company, Inc</p>
                <a href="/" class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">
                    <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap" /></svg>
                </a>
                <ul class="nav col-md-4 justify-content-end">
                    <li class="nav-item"><a href="~/" class="nav-link px-2 text-muted">@Resources.Resource.Home</a></li>
                    @*<li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Features</a></li>
                    <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Pricing</a></li>
                    <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">FAQs</a></li>
                    <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">About</a></li>*@
                </ul>
            </footer>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <nav>
                        <div class="nav nav-tabs d-flex align-items-center justify-content-center" id="login-register-tabs" role="tablist">
                            <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">@Resources.Resource.LoginTitle</button>
                            <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">@Resources.Resource.RegistTitle</button>
                        </div>
                    </nav>
                    <br />
                    <div class="tab-content" id="login-register-tabs-content">
                        <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
                            <!-- Login form goes here -->
                            <div class="d-flex align-items-center justify-content-center">
                                <form class="">
                                    <div class="form-floating mb-4">
                                        <input type="text" class="form-control form-control-lg rounded-3" id="inputAccount" placeholder="AD Account/ System Account">
                                        <label for="inputAccount">@Resources.Resource.Account</label>
                                    </div>
                                    <div class="form-floating mb-4">
                                        <input type="password" class="form-control form-control-lg rounded-3" id="inputPassword" placeholder="Password">
                                        <label for="inputPassword">@Resources.Resource.Password</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control rounded-3 w-75" id="inputCaptcha" placeholder="Captcha">
                                        <label for="inputCaptcha">@Resources.Resource.Captcha</label>
                                        <input id="btn_refresh" name="btn_refresh" type="button" class="form-control w-25 mb-2 btn rounded-3 btn-primary" value="Refresh">

                                    </div>
                                    @*<button id="btn_login" class="w-100 mb-2 btn btn-lg rounded-3 btn-primary" type="submit">@Resources.Resource.LoginTitle</button>*@
                                    <input id="btn_login" name="btn_login" type="button" class="w-100 mb-2 btn btn-lg rounded-3 btn-primary" value="@Resources.Resource.LoginTitle">
                                    
                                </form>
                            </div>                            
                        </div>
                        <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
                            <!-- Register form goes here -->
                            <form class="">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control rounded-3" id="inputAccount" placeholder="AD Account/ System Account">
                                    <label for="inputAccount">@Resources.Resource.Account</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="password" class="form-control rounded-3" id="inputPassword" placeholder="Password">
                                    <label for="inputPassword">@Resources.Resource.Password</label>
                                </div>
                                <input id="btn_regist" name="btn_login" type="button" class="w-100 mb-2 btn btn-lg rounded-3 btn-primary" value="@Resources.Resource.RegistTitle">
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <label id="lbl_errMsg"></label>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
